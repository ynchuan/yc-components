$.fn.catalogBar=function(){var t={},a=[];return $(".h2-tl").each(function(s){var l=$(this),i=[];s++,t[l.text().replace(/\s*/g,"")]={index:s,sub:i},a.push(l),l.attr("id",s).next().children(".h3-tl").each(function(t){var l=$(this),o={};t++,l.attr("id",s+"-"+t),o[l.text().replace(/\s*/g,"").replace(/\(\d*\)/,"")]=s+"-"+t,i.push(o),a.push(l)})}),new CatalogBar(t,$(this),a),this};var CatalogBar=function(t,a,s){this.data=t,this.tar=a,this.headlist=s,this.$doc=$(document),this.render(),this.addScrollEvent(),this.addClickEvent()};CatalogBar.prototype.render=function(){var t=this.data,a='<div class="yc-side-catalog">  <i class="icon-circle-top"></i><div class="yc-catalog-show"><div class="d-catalog-content"> <dl class="dl-catalog">';for(var s in t){a+='<dt class="dt-catalog-root"><i class="icon-point"></i><a href="#'+t[s].index+'" class="a-catalog"><strong class="st-cat">'+t[s].index+"</strong> "+s+"</a></dt>";for(var l=0;l<t[s].sub.length;l++){var i=t[s].sub[l];for(var o in i)a+='<dd class="dd-catalog-child"><a href="#'+i[o]+'" class="a-catalog"><strong class="st-cat">'+i[o]+"</strong> "+o+"</a></dd>"}}a+='</dl><div class="d-index-axis"><span class="sp-index"></span> </div></div></div><i class="icon-circle-bottom"></i><div class="yc-catalog-hide"> <i class="icon-toggle-catalog"></i> <i class="icon-scroll-top"></i> </div></div>',this.tar.html(a)},CatalogBar.prototype.addScrollEvent=function(){catlist=this.catlist=this.tar.find(".dl-catalog").children(),pointer=this.pointer=this.tar.find(".sp-index"),h=this.h=catlist.height(),headlist=this.headlist,_this=this,console.log(h),this.scrollbar=this.tar.find(".d-catalog-content"),this.scrollH=this.scrollbar.parent().height(),$(window).on("scroll",function(){var t=$(this).scrollTop();if(headlist[0].offset().top>t)_this.scrollPointBar(0),_this.scrollCatalog(0);else for(var a=0,s=headlist.length-1;s>a;a++)if(headlist[a].offset().top<t&&headlist[a+1].offset().top>t){_this.scrollPointBar(a+1),_this.scrollCatalog(a+1);break}});{var t=this.scrollbar.height()-this.scrollH,a=80;Math.ceil(t/a)}t>0&&this.scrollbar.parent().on("mousewheel",function(s){s.preventDefault(),s=s?s:window.event;var l=s.delta=s.originalEvent.wheelDelta?s.originalEvent.wheelDelta/120:-(s.detail||0)/3,i=parseInt(_this.scrollbar.css("margin-top"))+l*a;i=-t>i?-t:i>0?0:i,_this.scrollbar.css("margin-top",i+"px")})},CatalogBar.prototype.addClickEvent=function(){var t=this.$doc,a=this;this.tar.on("click",".icon-toggle-catalog,.icon-scroll-top,.dt-catalog-root,.dd-catalog-child",function(){var s=$(this);s.hasClass("icon-toggle-catalog")&&function(){s.parent().prevAll().toggleClass("hide")}(),s.hasClass("icon-scroll-top")&&function(){t.scrollTop(0)}(),(s.hasClass("dt-catalog-root")||s.hasClass("dd-catalog-child"))&&function(){var t=s.index();a.scrollPointBar(t)}()})},CatalogBar.prototype.scrollPointBar=function(t){this.catlist.removeClass("cat-hover").eq(t).addClass("cat-hover");var a=this.h*t+6;this.pointer.css("top",a+"px")},CatalogBar.prototype.scrollCatalog=function(t){var a=this.h*t+6,s=a-this.scrollH;s>=0?this.scrollbar.css("margin-top",-(s+this.h)+"px"):this.scrollbar.css("margin-top","0px")};