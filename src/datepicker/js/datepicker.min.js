!function(t){function e(e,a,i){!i&&(i=window.$),t=i,this.$dom=t(e),this.$tar=t(a)}e.prototype.init=function(){this.render(),this.listenEvent()},e.prototype.render=function(t){var e="",a=this.createDateList(t),i=this.getTodayDate(),n=a.pop();e+="<dt class='dt-date-title'><ul class='ul-date'><li class='li-date-title'><i class='icon-left'></i></li><li class='li-date-title' data-year="+n[0]+">"+n[0]+"年 <i class='icon-down-year'></i></li><li class='li-date-title' data-month="+n[1]+">"+n[1]+"月 <i class='icon-down-month'></i></li><li class='li-date-title'><i class='icon-right'></i></li></ul></dt>",e+="<dt class='dt-date-head'><ul class='ul-date'><li class='li-date-head'>一</li><li class='li-date-head'>二</li><li class='li-date-head'>三</li><li class='li-date-head'>四</li><li class='li-date-head'>五</li><li class='li-date-head'>六</li><li class='li-date-head'>日</li></ul></dt><dd class='dd-date-body'>";for(var l=0;l<a.length;l++){if(l%7==0&&(e+="<ul class='ul-date'>"),a[l]){var s=a[l],o="";this.currMonth+this.lt9(s)==i&&(o="li-today"),e+=" <li class='li-date "+o+"'>"+a[l]+"</li> "}else e+=" <li class='li-empty'></li> ";l%7==6&&(e+="</ul>")}return e+="</dd><div class='mask'></div>",this.$dom.html(e),this},e.prototype.listenEvent=function(){var e=this;this.$dom.on("click",function(a){var i=t(a.target);i.hasClass("icon-right")&&function(){e.nextMonth()}(),i.hasClass("icon-left")&&function(){e.preMonth()}(),i.hasClass("li-date")&&function(){var t=i.text();sltdt=e.currMonth+(t.length>1?t:"0"+t),e.$tar.val(sltdt),this.pretar&&this.pretar.removeClass("active"),i.addClass("active"),this.pretar=i}(),i.hasClass("icon-down-year")&&function(){var t=i.parent();if(!t.find(".ul-date-list").length){var n=t.data("year"),l=e.droplist(parseInt(n),"year");t.append(l)}t.find(".ul-date-list").show(),a.stopPropagation()}(),i.hasClass("icon-down-month")&&function(){var t=i.parent();if(!t.find(".ul-date-list").length){var n=t.data("month"),l=e.droplist(parseInt(n));t.append(l)}t.find(".ul-date-list").show(),a.stopPropagation()}()}),t(document).on("click",function(){t(".ul-date-list").hide()})},e.prototype.droplist=function(t,e){var a,i,n="<ul class='ul-date-list'>";"year"==e?(start=t-6,i="年"):(start=0,i="月");for(var l=1;13>l;l++)a=start+l==t?"active":"",n+="<li class='li-date-list "+a+"'>"+(start+l)+i+"</li>";return n+="</ul>"},e.prototype.createDateList=function(t){var e=this.getMonthFirstDate(t),a=this.getMonthLastDate(t),i=0,n=0,l=[];i=e[3]?e[3]-1:6,n=a[3]?7-a[3]:0;var s={start:i,during:a[2],end:n};for(var o in s)if("during"==o)for(var r=1;r<=s[o];r++)l.push(r);else for(var r=0;r<s[o];r++)l.push(0);return l.push(e),l},e.prototype.nextMonth=function(){this.chekoutMonth(0)},e.prototype.preMonth=function(){this.chekoutMonth(2)},e.prototype.chekoutMonth=function(t){var e=this.$dom.find(".dt-date-title"),a=e.find(".li-date-title"),i=a.eq(1).data("year"),n=a.eq(2).data("month"),l=new Date(parseInt(i),parseInt(n)-t),s=l.getFullYear()+"-"+(l.getMonth()+1)+"-01";this.render(s)},e.prototype.getTodayDate=function(){var t=new Date,e=t.getFullYear(),a=t.getMonth()+1,i=t.getDate();return this.formate(e,a,i)},e.prototype.getMonthFirstDate=function(t){var e,a;e=t?new Date(t):new Date,a=new Date(e.getFullYear(),e.getMonth());var i=a.getFullYear(),n=a.getMonth()+1,l=a.getDate();return this.currMonth=this.formate(i,n),[i,n,l,a.getDay()]},e.prototype.getMonthLastDate=function(t){var e,a,i;e=t?new Date(t):new Date,a=new Date(e.getFullYear(),e.getMonth()+1),i=new Date(a.getTime()-864e5);var n=i.getFullYear(),l=i.getMonth()+1,s=i.getDate();return[n,l,s,i.getDay()]},e.prototype.lt9=function(t){return"number"==typeof t?t>9?t:"0"+t:""},e.prototype.formate=function(t,e,a){return t+"-"+this.lt9(e)+"-"+this.lt9(a)},"function"==typeof define&&(define.amd||define.cmd)?define(function(t,a,i){i.exports=e}):window.DatePicker=e}();