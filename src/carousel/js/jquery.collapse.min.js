!function($){$.fn.grpcollapse=function(t){if("object"==typeof t){var e=$.extend({isHidePre:!0,hideArrow:!1,hasdot:!1},t),i=$(this),a=new collapse(i,e);a.createDomStrcs(),a.initCollapse(e),a.addClickListener(),this.clps=a}else if("object"!=typeof t)try{this.clps.initCollapse(t)}catch(s){new collapse($(this),{}).initCollapse(t)}return this};var collapse=function(t,e){this.preicon,this.preitem,this.pren,this.preuid,this.presubItem,this.count=0,this.dom=t,this.data=e.data,this.opts=e,this.preisEmpty};collapse.prototype={createDomStrcs:function(){var t="<ul class='grp_collpase_ul'>";t+=this.dataiteration("root",this.data,1),t+="</ul>",this.dom.html(t)},dataiteration:function(relate,data,n){for(var domStr="",i=0;i<data.length;i++){var dataObj=data[i];with(dataObj){var mark="";this.opts.hasdot&&1!=n&&(mark="&middot;&nbsp;"),domStr+="<li class='grp_collpase_li'><div class='grp_collpase_item' data-bind='"+JSON.stringify(dataObj)+"' data-toggle='show'  data-relate="+relate+" data-uid="+uid+" data-leval="+n+"><span class='grp_collpase_span'><span class='grp_collpase_icon' style='background-image:url("+icon+");_background:none;_filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src="+icon+", sizingMethod=&apos;crop&apos;)'></span></span><span class='grp_collpase_txt'>"+mark+title+"</span><span class='grp_collpase_span'><span class='grp_collpase_icon grp_collapse_right' ></span></span></div></li>",sublist&&(domStr+=arguments.callee.call(this,uid,sublist,n+1))}}return domStr},initCollapse:function(t){var e=this;if("string"==typeof t){var i=this.dom.find(".grp_collpase_ul [data-uid='"+t+"']"),a=i.data("relate");return"root"!=a&&this.dom.find(".grp_collpase_ul [data-uid="+a+"]").trigger("click"),i.trigger("click"),void("root"==a&&this.count++)}if("number"==typeof t){var i=this.dom.find(".grp_collpase_ul [data-relate=root]").eq(t);return void i.trigger("click")}this.dom.find(".grp_collpase_item[data-relate=root]").each(function(){var t=$(this).data("bind").uid;$(this).data("toggle","hide");var i=$("[data-relate="+t+"]");i.hide().find(".grp_collpase_icon").removeClass("grp_collapse_right"),e.opts.hideArrow&&!i.length&&$(this).find(".grp_collpase_icon").removeClass("grp_collapse_right")})},isIE6:function(){var t=!1;return $.browser.msie&&~~$.browser.version<8&&(t=!0),t},dealImage:function(t){return t},addClickListener:function(){var t=this;this.dom.on("click",".grp_collpase_item",function(){var e=$(this).data("leval");1==e?t.rootClickDeal($(this)):2==e&&t.subClickDeal($(this))})},rootClickDeal:function(t){var e=t.data("toggle"),i=t.data("bind"),a=i.uid,s=t.data("leval"),r=i.activeicon,o=i.icon,l=$("[data-relate="+a+"]"),p=!l.length;this.dealPreItem(),t.addClass("active").find(".grp_collpase_icon").eq(0).css({"background-image":"url("+r+")",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+r+"', sizingMethod='crop')"}),this.isIE6()&&t.find(".grp_collpase_icon").eq(0).css({background:"none"}),p?0!=this.count&&(this.opts.clickEvent.call(t,event,t.data("bind")),this.count++):"show"==e?(t.data("toggle","hide"),l.hide(),t.find(".grp_collpase_icon").eq(1).removeClass("grp_collapse_down").addClass("grp_collapse_right")):(t.data("toggle","show"),l.show(),t.find(".grp_collpase_icon").eq(1).removeClass("grp_collapse_right").addClass("grp_collapse_down")),this.preicon=o,this.preitem=t,this.pren=s,this.preuid=a,this.preisEmpty=p},dealPreItem:function(){this.preitem&&this.preitem.removeClass("active").find(".grp_collpase_icon").eq(0).css({"background-image":"url("+this.preicon+")",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+this.preicon+"', sizingMethod='crop')"}),this.isIE6()&&this.preitem&&this.preitem.find(".grp_collpase_icon").eq(0).css({background:"none"}),!this.preisEmpty&&this.opts.isHidePre&&(this.preitem&&this.preitem.data("toggle","hide"),this.preuid&&this.pren&&$("[data-relate="+this.preuid+"]").hide()),this.preisEmpty||(this.preitem&&"show"==this.preitem.data("toggle")&&this.preitem.find(".grp_collpase_icon").eq(1).removeClass("grp_collapse_right").addClass("grp_collapse_down"),this.preitem&&"hide"==this.preitem.data("toggle")&&this.preitem.find(".grp_collpase_icon").eq(1).removeClass("grp_collapse_down").addClass("grp_collapse_right"))},subClickDeal:function(t){this.presubItem&&this.presubItem.removeClass("active"),t.parent().addClass("active"),this.presubItem=t.parent(),0!=this.count&&this.opts.clickEvent.call(t,event,t.data("bind")),this.count++}}}(jQuery);